<%- include("../../views/layouts/user/header") %>
<section class="content-main mt-80 mb-80">
    <div class="card mx-auto card-login col-4">
      <div class="card-body">
        <h4 class="card-title mb-4">Reset Password</h4>
        <form method="post" action="/reset-password" onsubmit="return validatePasswords()">
          <div class="mb-3">
            <input class="form-control" name="newPass1" placeholder="New Password" type="password" id="newPass1">
            <div class="error-message" id="pass1-error"></div>
          </div>
          <div class="mb-3">
            <input class="form-control" name="newPass2" placeholder="Confirm Password" type="password" id="newPass2">
            <div class="error-message" id="pass2-error"></div>
          </div>
          <% if (locals.message) { %>
            <div class="alert alert-danger"><%= message %></div>
          <% } %>
          <div class="mb-4">
            <button type="submit" class="btn btn-primary w-100">Change Password</button>
          </div>
        </form>
      </div>
    </div>
  </section>
<script>
    function validatePasswords() {
      const pass1 = document.getElementById('newPass1');
      const pass2 = document.getElementById('newPass2');
      const pass1Error = document.getElementById('pass1-error');
      const pass2Error = document.getElementById('pass2-error');
      const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/;
    
      // Reset errors
      pass1Error.textContent = '';
      pass2Error.textContent = '';
      pass1.classList.remove('is-invalid');
      pass2.classList.remove('is-invalid');
    
      if (!passwordRegex.test(pass1.value)) {
        pass1Error.textContent = 'Password must be at least 8 characters long and contain uppercase, lowercase and numbers';
        pass1.classList.add('is-invalid');
        return false;
      }
    
      if (pass1.value !== pass2.value) {
        pass2Error.textContent = 'Passwords do not match';
        pass2.classList.add('is-invalid');
        return false;
      }
    
      return true;
    }
    </script>
<%- include("../../views/layouts/user/footer") %>
